-- teste ccr
select * from CC_integracaoPRTPGT a where a.ipp_unidadeorigem='PRT15' and a.ipp_unidadedestino='PGT' and a.ipp_idprocedimento_origem=76547 and a.ipp_ativo='S' and a.ipp_enviado='S' and a.ipp_tipointegracao='PRT_PARA_CCR';

-- teste prt
select * from CC_integracaoPRTPGT a where a.ipp_unidadeorigem='PGT' and a.ipp_unidadedestino='PRT15' and a.ipp_idprocedimento_destino=76641 and a.ipp_ativo='S' and a.ipp_enviado='S' and a.ipp_tipointegracao='CCR_PARA_PRT';




-- descobre processos na CCR enviados pela PRT -----------
select GROUP_CONCAT(a.ipp_idprocedimento_origem) as resultado from CC_integracaoPRTPGT a where a.ipp_tipointegracao='PRT_PARA_CCR' and a.ipp_unidadeorigem='PRT15' and a.ipp_unidadedestino='PGT' and a.ipp_ativo='S' and a.ipp_enviado='S'
		
-- descobre na PRT os enviados sem correspondencia na CCR (com base nos encontrados no sql acima)
select * from CC_integracaoPRTPGT a where a.ipp_unidadeorigem='PRT15' and a.ipp_unidadedestino='PGT' and a.ipp_ativo='S' and a.ipp_enviado='S' and a.ipp_tipointegracao='PRT_PARA_CCR'	and 
a.ipp_idprocedimento_origem not in (74567,72750,72796,76156,66992,76547,77300,76291,68973,59962,74169,68849,69103,70859,75854,74454,74921,73848,68613,60302,65107,51552,63737,73932,72801,73446,74229,64329,75826,61288,75186,72556,74863,74338,76246,49356,72070,71629,67483,61848,69534,72729,70067,72181,70523,72034,70020,61524,69105,61441,58766,76641,70405,68566,75149,74210,68757,74550,68977,70170,67517,69001,62646,68672,69792,77237,71872,72879,55381,69266,70362,70869,70899,76111,63424,61690,77744,66619,73052,66449,60444,76260,72695,73628,67961,77026,75617,74640,66429,71784,73705,67470,69918,73592,61693,73286,73789,68847,73278,65238,74421,62076,73945,69766,72953,73323,76799,74254,76530,73349,69360,68018,67116,68052,59198,64471,77114,58993,75445,72665,63047,33528,66360,67606,70301,64851,74194,72663,72283,76339,73384,71705,72093,61368,74138,39707,75777,72416,74058,62371,68064,65401,70878,75245,76013,68507,76062,73312,75343,74898,63022,38608,53604,75386,73462,71786,70984,76946,76706,75228,64454,73776,75189,66056,69910,58885,68078,47584,54291,52458,68063,76737,64921,75951,63276,77685,77109,76053,55982,74200,75187,74201,73903,76998,77010,77669,65443,72585,71376,66502,69240,73975,35106,68598,75620,69090,74949,60611,51308,61310,67245,61989,75537,76725,73878,73858,76212,65610,73713,66481,75293,72718,73449,75200,75574,60804,72999,57198,69261,58778,65480,69830,29996,77864,69166,61667,76324,78373,78147,73121,64697,74301,68371,67997,54262,74396,63787,65655,76748,72959,41833,61435,77068,65829,70942,64604,76764,66576,69295,55058,74619,70252,77090,65868,73269,76494,74968,63631,75261,74049,71093,74743,70877,73664,52796,77648,50168,65569,74796,74788,75632,66721,59946,65081,19945,70955,76147,54003,74464,63854,60194,74576,74112,65439,67809,78907,72126,49254,44272,72947,48907,65367,62167,67320,61975,76024,75789,67512,74958,66893,70651,72208,71908,75362,41681,72736,47706,48114,69400,71349,61036,63101,72410,76373,76200,73128,76775,79312,78105,73900,77789,76981,74176,74979,76190,78766,74477,71649,76888,77931,74466,76794,74680,76998,74201,78163,73124,63127,70254,65834,59043,74376,68326,72668,72944,42448,72861,70748,70067,61848,72181,77681,74837,65849,75827,77757,73766,68936,70935,69982,71295,66407,65819,76310,75683,46215,68396,78165,77273,72688,52327,70170,64652,70475,76270,74117,65376,74844,76316,70301,76220,75445,63047,68499,71937,63719,61524,63539,70790,66360,69103,74301,77425,57592,68672,69362,73549,60277,69923,71367,76124,70427,74617,66742,75750,70356,75980,62182,71520,76172,62401,69730,69279,73819,73529,72836,57427,77453,76378,62338,75703,72397,68338,68016,71301,67471,74396,78034,77445,73401,50246,57518,72150,74639,78949,76534,60741,71237,72031,72075,73841,73337,73744,75105,78661,55737,71666,69065,71006,78043,63535,62053,71680,70134,74935,78336,76686,76705,77088,70968,70938,71026,42017,69205,79398,77115,76665,74701,70608,77887,71682,66707,64668,64594,77428,61441,72034,79506,66877,74137,70665,75491,77990,61890,78550,75413,72602,75266,70657,67315,71717,69447,65637,78475,72678,68657,66668,54946,67917,63854,77896,56518,75921,51974,51287,77734,56494,57461,78474,74593,69317,75095,56189,76938,70632,70536,77022,62959,78913,72627,68029,76238,75326,75908,58939,76408,61137,76676,74637,75685,69538,74642,79350,56233,74902,64650,74989,71280,71654,73616,68565,78667,33739,76742,79370,79550,18625,69925,26421,75072,43267,62807,69787,43706,70005,68490,63867,76809,75976,79245,73150,79308,65060,68669,67218,68387,75514,71989,32392,68729,71663,72202,79987,78653,72869,72680,70868,75348,67579,74854,70440,77964,71446,79193,72705,73847,46145,73104,72004,73875,78088,74205,55381,64120,79100,60590,74994,57896,73279,73701,49510,78517,77968,79275,74609,70844,75305,78654,73787,79414,59543,66017,73901,73212,71868,77076,58971,55637,79253,76461,76252,67764,73436,69035,76019,72650,74080,70728,56080,76298,65346,63720,70455,61444,64685,58445,76417,61828,65298,69144,55617,77061,76159,77517,72607,16329,76483,74194,53569,57723,58324,64003,78360,65087,73915,76116,76695,78054,63314,79720,76772,68793,72920,71485,73481,71332,73805,74998,78856,57857,68642,78156,64074,64084,71826,46775,78854,67452,76539,74530,78237,69234,61366,72158,73258,75560,79439,78830,76696,69167,80309,76109,80411,78110,68502,78542,76990,67997,79083,80637,75810,75435,77188,73768,77405,78082,75910,79308,69469,78144,69994,74456,75949,81934,81918,81896,82046,79934,81121,57427,64247,66407,80256,74112,73126,66547,77274,71922,68060,79879,72624,75672,72734,74565,70878,71029,81094,70235,80963,70054,74403,72653,80754,79342,57573,78234,73134,72598,60786,78703,55680,64329,81136,76659,79400,77029,77052,77054,77082,78267,48212,76840,71670,80389,70073,71829,77491,59444,71868,76244,76103,77074,78262,74773,80990,77857,77938,69267,77637,71814,77184,78531,68985,71279,73308,60265,74964,73420,80428,69591,72667,77582,80516,69452,71903,77477,74381,78408,77107,55579,71993,73084,61306,82033,76162,80869,76154,79430,64079,68876,72952,70984,77044,75382,68430,79450,78039,74780,73800,80511,81147,76191,71209,68317,73084,77069,75143,73792,73729,29537,78295,60567,68912,72704,67906,72097,68182,63244,73127,77697,77756,78090,78130,78523,64003,79593,61310,81109,69550,71154,73854,73961,71903,77046,81567,62378,74158,33313,74390,61439,76283,70725,76081,75524,74984,47652,72515,61559,71671,78022,46256,78535,71690,79438,79734,76932,76702,75904,76285,76498,69693,80764,77921,79437,69187,68619,73663,79194,75145,75808,78983,76161,76123,77640,81132,74392,79122,80228,81451,74221,74851,59781,68872,69074,79560,80862,70852,75729,76533,82483,59998,75859,70187,75639,71571,72188,81163,78549,69762,59258,82871,80016,68699,78740,76630,76720,76945,77091,78505,80034,81004,77847,69896,72472,69459,77883,80832,77154,76170,78914,67889,75592,75625,51976,80839,79864,78040,80106,77462,80546,75179,74597,82317,76583,60841,56579,75047,82038,78307,77902,47147,68926,76924,78449,67035,73163,75656,75882,81903,78058,79919,74057,68986,69006,79863,79456,78829,80031,80058,78792,79366,71005,79543,70542,54886,79695,82424,80037,74489,78966,82538,81548,72682,77982,77270,75626,78593,72395,77474,74217,75451,73144,80472,80394,77268,81944,73857,75807,82138,69717,80768,70407,71552,70600,78429,71053,81315,73633,82532,77599,79104,62804,77710,78741,70717,82525,53212,78238,71689,74146,76461,62247,72956,78677,82519,76376,82883,66722,47652,77246,79341,60660,78815,71845,80075,82116,78178,79407,67051,79658,75791,76304,75933,77916,65185,77455,77926,59662,78337,79576,46495,78196,81790,80283,77208,77997,67445,79436,81168,77867,73165,70363,75959,74713,59266,79890,76049,59956,69471,78795,75042,70544,73358,82815,73960,80303,75947,72621,76370,75515,77334,80471,63303,56916,79739,80440,69202,71738,73418,75385,75349,79435,81075,70789,81105,74457,76670,63238,53049,60002,80551,78402,69635,78736,77932,78932,75300,80035,80369,75113,64683,80499,72123,67600,75666,72308,78585,43752,71740,79820,71920,78650,70284,77616,74915,82076,79788,75941,74127,74605,78113,72184,75099,71592,76275,80336,78794,77324,73416,77564,78254,80730,73114,70504,67736,79070,80437,52756,69943,62280,65465,77139,67576,76900,80533,78912,84678,79011,83217,58665,81386,73916,73793,78270,78274,82710,78754,78349,75549,80081,78097,77403,73917,78465,78476,80556,79594,76574,79336,79681,79973,79777,75547,76776,81842,81609,77347,68771,78970,77713,52331,78639,82229,58775,53761,62043,69745,71212,77897,69791,78648,79966,82954,80135,83283,81789,63730,76145,48390,73112,83751,75608,70018,75080,78447,82347,72282,67068,59585,48824,76663,77556,74364,63737,63813,79596)
	


-- descobre processos na PRT devolvidos pela CCR
 select GROUP_CONCAT(a.ipp_idprocedimento_destino) from CC_integracaoPRTPGT a where a.ipp_unidadeorigem='PGT' and a.ipp_unidadedestino='PRT15' and a.ipp_ativo='S' and a.ipp_enviado='S';

 -- descobre na CCR os devolvidos sem correspondencia na PRT (com base nos encontrados no sql acima)
 select * from CC_integracaoPRTPGT a where a.ipp_unidadeorigem='PGT' and a.ipp_unidadedestino='PRT15' and a.ipp_ativo='S' and a.ipp_enviado='S'
 and a.ipp_idprocedimento_destino not in (77109,61586,71872,72750,72034,61441,64329,70067,73932,66360,75445,55381,68672,70170,76641,61524,72181,61848,60302,74201,70878,70984,74396,61310,67997,76998,69103,74194,63047,70301,74301,76111,76339,70523,71784,69105,78373,76530,72801,55982,74169,75951,77669,69910,72729,69001,68063,60611,68849,67470,77300,76737,65107,68598,33528,66449,74949,74454,76291,74338,51308,65238,64851,61667,67961,75826,75777,76156,73462,73312,66481,72283,61690,75343,72953,72070,58885,64454,74229,75189,66429,73449,70869,53604,76799,68566,69266,76013,76062,70405,54262,68507,69090,78147,69360,75228,70899,77109,68371,69792,72556,67483,38608,68757,67116,75537,76547,64921,74863,66992,29996,73878,76260,69830,66502,74210,49356,69918,75620,58993,74421,73286,60444,73349,62371,73121,75187,77237,72585,73945,75293,75200,73705,71629,74550,75854,58766,62646,74058,73903,72718,57198,72879,73052,69240,76053,70362,70020,70859,68064,68052,68977,73975,77685,73628,77010,72999,75149,65480,66619,35106,68847,68613,72093,74921,65610,76324,58778,68973,66056,73848,73446,76246,68078,74138,69766,47584,63424,75617,73384,73278,73323,65443,51552,59962,59198,69261,77026,75186,71376,73592,74640,54291,62076,72796,69534,73789,61693,73858,74117,75362,65367,78949,75386,79312,52458,41681,42448,19945,48114,48907,50168,41833,39707,55058,46215,59043,52796,52796,54003,61036,61288,61368,61848,49254,61524,62167,60194,63539,60277,59946,60804,61989,63022,63631,61435,62182,64471,63787,63127,62338,61975,63276,65569,66360,65401,67517,65819,67606,65439,68499,66893,69166,68936,69362,64697,69103,70170,68672,69400,69923,70067,70301,70252,70877,71349,71237,70748,71093,70790,71908,72208,71649,72031,65081,72075,69279,70955,64652,70475,65849,72181,65868,70356,70935,72410,70942,69295,66576,66721,64604,68016,68018,72397,68396,71705,68338,72416,69982,65834,70427,72665,72668,72688,72861,71786,71295,73269,72947,73529,72736,74200,74176,72126,74968,74201,73549,75245,74958,74979,75261,74049,74049,76124,75445,76316,76748,76494,76378,75703,77864,72959,76998,76888,76946,74576,73819,76725,77425,74254,72695,73713,76706,74567,74796,77453,75827,77757,76794,74396,78105,73124,74466,73766,73776,76172,74898,74680,74477,76212,76775,77931,77114,77445,75574,76200,72663,74837,76373,78163,76310,74619,77068,77273,52796,74049,63854,67471,67320,66407,74112,70254,79308,69447,64003,57427,67218,78360,79253,54946,71868,70632,79342,78531,55238,60405,71903,51974,76534,79398,81121,79308,81918,82046,81934,81896,63854,80411,77744,79193,62401,74593,76252,79506,76764,67245,73337,26421,18625,32392,43267,33739,43706,47706,46775,16329,48212,50246,51287,49510,44272,55381,55737,56080,56189,52327,55637,56233,56494,46145,57461,57573,53569,55617,57518,57427,57857,57592,58445,55680,59543,57896,56518,61137,61890,60590,61366,61441,63101,61444,63047,63719,64329,62959,62053,58324,61828,59444,63535,64120,62807,63314,58971,60741,60786,64074,63720,63867,64650,64084,64247,64668,65346,57723,65637,64685,67512,67764,66707,67315,65087,67997,68029,68565,68326,68490,69205,68642,69538,69317,69787,68729,69925,69035,70235,70608,70665,70878,71029,70968,70938,71332,71663,71680,71280,71367,71485,71937,70868,67809,72034,64594,72202,71682,65298,70657,71006,67917,71826,71989,67452,65376,66547,72158,66017,68793,71666,70651,72004,65655,68060,70844,70455,66877,68502,71520,71026,66668,71446,69730,66742,68657,69144,70440,67579,68669,69234,71922,71654,68387,65060,66407,70005,70054,70536,71717,70134,72678,72680,71301,72944,65829,72624,73664,73701,73279,73900,73481,74194,73915,74743,73805,74112,74902,74301,74530,75072,74844,74998,75560,75326,75750,75491,75672,76024,76109,75810,75348,75910,75949,76539,76461,76190,76695,76659,76116,76696,76938,76981,76705,77088,77517,76686,77887,77734,78043,76742,77789,78054,77090,78517,78156,78550,78110,78661,78475,78854,78856,78474,78667,78766,79370,79439,79083,78907,79550,80637,79100,80754,80963,72836,74403,79879,72734,81094,74935,79245,75305,75921,78237,78267,78654,74788,72602,74854,79414,74456,75435,75413,74565,77968,72627,76840,75266,73841,73875,73847,74464,74205,73744,72869,74609,76147,76417,77274,76809,77428,76270,75105,78034,79934,80256,78913,72705,75685,75095,74137,75980,80309,75908,78088,79275,72650,76665,77964,73126,73150,73212,73104,78542,72607,73128,74376,74080,73901,74617,77115,78234,76483,72598,75683,76298,78653,73401,75514,73258,77896,72653,73768,73616,74639,76019,74642,73436,76220,75632,76772,76238,74637,76408,76990,77054,77052,77061,77188,77022,74994,77076,78165,77405,78336,77082,81136,77990,78082,78703,73084,80516,82033,47652,59781,79987,68182,69469,75976,80428,77648,76244,61306,29537,55579,61559,64003,62378,60265,68912,68985,71209,63244,64079,71279,72515,61439,70073,71670,71829,72097,71671,70725,68876,67906,69452,69167,71993,69550,71154,71814,69994,71868,68430,72150,69267,70728,74984,74390,75524,72704,76103,74989,76285,76498,75904,76702,76191,76283,78262,79430,78830,76932,79734,77921,78039,78295,73729,78535,73127,74381,74701,73792,79593,77491,74780,80389,80511,75143,79400,80990,73854,77697,79720,78130,73787,73961,78090,74773,77756,74158,73134,81567,72952,76159,76081,76154,75382,77029,73084,77044,74964,77069,77184,77046,77107,77074,73800,77637,78144,78408,79450,77857,77883,76461,80472,77681,65511,46866,69065,69591,77640,82525,82532,73420,82483,75789,72920,79456,77582,80228,81548,75047,69459,68926,82424,47147,79543,78307,75882,72395,33313,79122,59258,80862,79366,75859,78593,74392,74221,71689,71571,60567,75807,77710,75808,70187,77982,72472,74057,76676,80832,76720,71552,80016,81903,76170,70542,75626,78523,78983,80394,74851,73144,76161,69717,68619,75179,73633,73163,77599,68317,54886,79863,69006,70717,58939,80839,81163,77462,79560,78040,78505,72188,62804,79194,77847,81315,73857,70984,75656,72667,77091,81147,80768,78549,69896,76630,77270,69187,82138,74597,75625,78677,78429,78966,75639,70600,77474,77477,76533,71903,74146,78792,76162,59998,80037,67889,75729,80034,51976,81451,78740,80106,68986,69693,60841,80764,79437,81944,42017,74489,76376,71690,61310,80058,78829,77154,78449,46256,70852,75451,72682,75145,76924,79695,81132,80546,71053,82317,69762,77268,80031,81004,69074,76123,77938,81109,75592,77902,78238,78914,70407,68699,68872,78022,74217,76583,78741,73663,56579,79864,80869,71005,82871,79919,73308,67035,63737);




select -- concat("update SI_processopj set ppj_ativo='N' where ppj_idprocessopj=",a.ppj_idprocessopj," limit 1;"),
-- concat("select * from SI_processopj where ppj_ativo='S' and ppj_CNJnumero=",ppj_CNJnumero," and ppj_CNJdigito=",ppj_CNJdigito," and ppj_CNJano=",ppj_CNJano," and ppj_CNJsegmento=",ppj_CNJsegmento," and ppj_CNJregiao=",ppj_CNJregiao," and ppj_CNJorgao=",ppj_CNJorgao,";"),
concat(ppj_CNJnumero,ppj_CNJdigito,ppj_CNJano,ppj_CNJsegmento,ppj_CNJregiao),
-- a.ora_idprocesso,a.ppj_idprocessopj,a.ppj_dtinc,a.ppj_CNJnumero,a.ppj_CNJdigito,a.ppj_CNJano,a.ppj_CNJsegmento,a.ppj_CNJregiao,a.ppj_CNJorgao,
(select count(b.ppj_idprocessopj) as totalHistorico from SI_historicopj b where a.ppj_idprocessopj=b.ppj_idprocessopj and b.hpj_ativo='S') as totalHistorico
from SI_processopj a where a.ppj_ativo='S'
having totalHistorico <= 0;

select concat(ppj_CNJnumero,ppj_CNJdigito,ppj_CNJano,ppj_CNJsegmento,ppj_CNJregiao),
(select count(b.ppj_idprocessopj) as totalHistorico from SI_historicopj b where a.ppj_idprocessopj=b.ppj_idprocessopj and b.hpj_ativo='S') as totalHistorico
from SI_processopj a where a.ppj_ativo='S'
having totalHistorico <= 0;